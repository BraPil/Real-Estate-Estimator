# V3.2 Fresh Data Experiment Results

**Date:** December 9, 2025  
**Branch:** main  
**Commits:** 74df50c (Phase 1), ff66fb2 (Phase 2)

## Executive Summary

V3.2 validated the model's ability to adapt to fresh 2020+ King County housing data. After retraining on 155,855 records from 2020-2024, the model achieved:

- **CV MAE: $258,958** (acceptable for median price of $845K)
- **R2: 0.7267** (explains 73% of variance)
- **MAPE: 29.1%**

This represents a dramatic improvement over zero-shot evaluation (no retraining), where the V2.5 model achieved only:
- MAE: $679,030
- R2: 0.2906
- MAPE: 60.4%

## Data Source

**King County Department of Assessments** (kingcounty.gov/assessor)

Files used:
- `EXTR_RPSale.csv` - 609MB, all real property sales
- `EXTR_ResBldg.csv` - 147MB, residential building characteristics
- `EXTR_Parcel.csv` - 236MB, parcel details

After filtering and joining:
- **155,855 valid records** (single-family residential, 2020+)
- Date range: January 2020 - December 2024
- Median sale price: $845,000

## Feature Mapping

Original 17 features from `kc_house_data.csv` were mapped from assessment data:

| Original Feature | Assessment Source | Notes |
|------------------|-------------------|-------|
| price | SalePrice | Target variable |
| bedrooms | Bedrooms | Direct mapping |
| bathrooms | BathFullCount + BathHalfCount*0.5 | Computed |
| sqft_living | SqFtTotLiving | Direct mapping |
| sqft_lot | SqFtLot | Direct mapping |
| floors | Stories | Direct mapping |
| waterfront | WfntLocation > 0 | Binary conversion |
| view | ViewUtilization | Ordinal mapping |
| condition | Condition | Direct mapping |
| grade | BldgGrade | Direct mapping |
| sqft_above | SqFt1stFloor + SqFtUpperFloor | Computed |
| sqft_basement | SqFtFinBasement + SqFtUnfinFull | Computed |
| yr_built | YrBuilt | Direct mapping |
| yr_renovated | YrRenovated | Direct mapping |
| zipcode | ZipCode | Direct mapping |
| lat | Synthetic | Zipcode-based approximation |
| long | Synthetic | Zipcode-based approximation |

## Results Comparison

### Zero-Shot (V2.5 on 2020+ data, no retraining)

| Metric | Value | Notes |
|--------|-------|-------|
| MAE | $679,030 | Severe underprediction |
| RMSE | $856,234 | High variance |
| R2 | 0.2906 | Only 29% variance explained |
| MAPE | 60.4% | Unacceptable error rate |

### V3.2 (Retrained on 2020+ data)

| Metric | Value | Improvement |
|--------|-------|-------------|
| CV MAE | $258,958 | 62% reduction |
| RMSE | $492,519 | 42% reduction |
| R2 | 0.7267 | +0.44 (150% improvement) |
| MAPE | 29.1% | 52% reduction |

### V2.5 Baseline (on original 2014-2015 data)

| Metric | Value |
|--------|-------|
| CV MAE | $63,529 |
| Test R2 | 0.8806 |
| MAPE | ~14% |

## Performance by Price Tier (V3.2)

| Tier | MAE | MAPE | R2 | Samples | % Data |
|------|-----|------|-----|---------|--------|
| < $400K | $351,299 | 196% | -25.15 | 2,585 | 5.2% |
| $400K-$600K | $121,792 | 24.4% | -12.72 | 8,382 | 16.8% |
| $600K-$800K | $133,334 | 19.2% | -14.49 | 11,722 | 23.5% |
| $800K-$1M | $169,468 | 19.1% | -21.74 | 8,443 | 16.9% |
| $1M-$1.5M | $220,067 | 18.1% | -3.91 | 9,885 | 19.8% |
| > $1.5M | $502,689 | 19.7% | 0.48 | 8,947 | 17.9% |

**Key Observations:**
- Highest MAPE in lowest tier (<$400K) - these may be distressed sales
- Most consistent MAPE (18-20%) in $600K-$1.5M range
- Only 5% of data in <$400K tier (market has moved up)

## Files Created

```
src/data/transform_assessment_data.py   # Data transformation pipeline
src/train_fresh_data.py                  # Training script for fresh data
scripts/evaluate_zero_shot.py           # Zero-shot evaluation
scripts/explore_assessment_data.py      # Data exploration utilities
data/assessment_2020_plus_full.csv      # Transformed training data (155K records)
data/zero_shot_evaluation.json          # Evaluation results
```

## Key Learnings

1. **Price Inflation Impact**: 2015 median ~$450K vs 2020+ median $845K (+88%)
   - Absolute MAE naturally higher, but MAPE is the relevant metric

2. **Feature Availability**: Assessment data provides excellent feature coverage
   - 68% join rate (sales + building + parcel)
   - PropertyType 3 = single-family residential

3. **Model Generalization**: XGBoost pipeline transfers well
   - Same hyperparameters work reasonably
   - Feature importance patterns likely similar

4. **Synthetic Features**: Lat/long approximations work
   - Zipcode-based centroids maintain spatial patterns
   - Neighbor features (sqft_living15, lot15) set to same as property

## Recommendations

1. **For Production Use on 2020+ Data**: Use V3.2 model
   - Acceptable 29% MAPE for market conditions
   - Retraining monthly recommended as market evolves

2. **For Historical Analysis**: Keep V2.5 model available
   - Better performance on 2014-2015 data
   - Useful for backtesting

3. **Future Improvements**:
   - Add actual lat/long from parcel data
   - Include more property types (condos, townhomes)
   - Implement online learning for continuous updates

## Conclusion

V3.2 successfully demonstrates the model can be retrained on fresh data. While the absolute MAE is higher due to price inflation, the relative error (MAPE ~29%) is within acceptable bounds for real estate prediction. The experiment validates the data pipeline and confirms the XGBoost architecture generalizes to new market conditions.

